# Node.js - Koa2 框架 （微博）

## 第一章：整体知识点

<img src="/Users/doghuang/Library/Application Support/typora-user-images/image-20210904194638983.png" alt="image-20210904194638983" style="zoom: 25%;" />



## 第二章 技术选型

### 1、框架模型

```markdown
# express vs koa2 vs egg

```



### 2、创建项目

```markdown
# 步骤
		1、安装koa-generator
    		进入一个文件夹 （eg /Users/doghuang/Desktop/工作/koa2-weibo）
				npm install -g koa-generator
		2、检查node的版本 > 8.0
		
		3、创建项目
			koa2 -e 项目名称
				eg:  koa2 -e koa2-weibo-code
				
		4、进入目录 cd koa2-weibo-code 
		
		5、安装 依赖 npm i
```



### 3、启动

```markdown
npm run dev

http://localhost:3000/
```



### 4、上传项目到github

```markdown
1、创建git 仓库， git init
```

![image-20210904224851655](/Users/doghuang/Library/Application Support/typora-user-images/image-20210904224851655.png)

<img src="/Users/doghuang/Library/Application Support/typora-user-images/image-20210904224940655.png" alt="image-20210904224940655" style="zoom: 50%;" />

```markdown
2、在github中创建一个空的仓库
```

<img src="/Users/doghuang/Library/Application Support/typora-user-images/image-20210904231336245.png" alt="image-20210904231336245" style="zoom: 50%;" />

```markdown
3、找到仓库的https地址
	eg: https://github.com/lijiesheng/--koa2.git
```

![image-20210904231437639](/Users/doghuang/Library/Application Support/typora-user-images/image-20210904231437639.png)

```markdown
4、把本地的仓库关联到github.com 上面
	 git remote add origin https://github.com/sci99coder/vuetodo.git
	 
5、git add .

6、git commit -m '1'

7、git push origin master:master 
```



### 5、设置环境变量

```markdown
9、安装环境变量插件
	npm i cross-env -D
```

<img src="/Users/doghuang/Library/Application Support/typora-user-images/image-20210904232951951.png" alt="image-20210904232951951" style="zoom:67%;" />



### 6、代码结构

```markdown
1、创建	src 目录
2、将public文件夹 router文件夹 view文件夹 app.js 文件放入src 目录
```

<img src="/Users/doghuang/Library/Application Support/typora-user-images/image-20210904233448862.png" alt="image-20210904233448862" style="zoom: 67%;" />

![image-20210904233647320](/Users/doghuang/Library/Application Support/typora-user-images/image-20210904233647320.png)





### 7、代码提交commit 规范

```markdown
feat：新功能（feature）

fix：修补bug

docs：文档（documentation）

style： 格式（不影响代码运行的变动）

refactor：重构（即不是新增功能，也不是修改bug的代码变动）

test：增加测试

chore：构建过程或辅助工具的变动

build :改变了build工具 如 grunt换成了 npm

revert: 撤销上一次的 commit

	eg : git commit -m "refactor : 目录调整"
```



### 8、返回路由

> get 请求

```markdown
# 不传参数 json返回
router.get('/json', async (ctx, next) => {
  ctx.body = {
    title: 'koa2 json'
  }
})


# 传参数 json返回
router.get('/profile/:userName', async (ctx, next) => {
  let params = ctx.params;
  console.log("params====>",params);
  ctx.body = {
    title: 'this is a profile',
    userName : params.userName
  }
})

# 传多个参数 json返回
router.get('/loadMore/:userName/:pageIndex',async (ctx, next) => {
  let params = ctx.params;
  console.log("params====>",params);
  ctx.body = {
    title: 'this is a profile',
    userName : params.userName,
    pageIndex : params.pageIndex
  }
})
```

> post 请求

```markdown
router.post('/login',async (ctx, next) => {
  let params = ctx.request.body;
  console.log("params====>",params);
  ctx.body = {
    userName : params.userName,
    password : params.password
  }
})
```



